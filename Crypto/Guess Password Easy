#include <iostream>
#include <string>
#include <cstdlib>
#include <ctime>

using namespace std;

int main(int argc, char* argv[]) {
    if (argc < 2) {
        cout << "Usage: ./solve <5_char_leak>" << endl;
        return 1;
    }

    string leak = argv[1];
    
    // Get current time
    time_t current_time = time(0);

    // We check a window of time. Since you just connected, 
    // the server's time(0) is likely within the last 30-60 seconds.
    // We also check a bit into the future just in case of clock skew.
    for (int i = -60; i <= 60; ++i) {
        time_t seed = current_time + i;
        srand(seed); // Seed with the guessed timestamp

        // Generate the password exactly like the server does
        string res(20, '.');
        for (int j = 0; j < 20; ++j) {
            res[j] = 'a' + rand() % 26;
        }

        // Compare the first 5 chars with the leak provided by the server
        if (res.substr(0, 5) == leak) {
            cout << "--------------------------------" << endl;
            cout << "Match found at timestamp: " << seed << endl;
            cout << "FULL PASSWORD: " << res << endl;
            cout << "--------------------------------" << endl;
            return 0;
        }
    }

    cout << "No match found. Make sure your system time is roughly accurate." << endl;
    return 0;
}
 nc guess-password-easy.2025-bq.ctfcompetition.com 1337
== proof-of-work: disabled ==
Password is dskth...............
Your guess: dskthsugadbpwhqqjctf
CTF{Did_y0u_h4v3_4_gr347_7im3_l00king_f0r_7h3_s33d?}
